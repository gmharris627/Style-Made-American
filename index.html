<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Style Made American â€“ Directory</title>

  <!-- DataTables CSS -->
  <link rel="stylesheet"
        href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">

  <!-- jQuery (required) -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

  <!-- DataTables JS -->
  <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>

  <style>
    body {
      font-family: Georgia, serif;
      padding: 2rem;
    }

    table.dataTable thead th {
      border-bottom: 1px solid #ccc;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>

<h1>Style Made American</h1>

  <div id="filters" style="margin-bottom:1rem;">
  <label>
    Garment Type:
    <select id="filter-garment">
      <option value="">All</option>
    </select>
  </label>

  <label style="margin-left:1rem;">
    Price Point:
    <select id="filter-price">
      <option value="">All</option>
    </select>
  </label>

  <label style="margin-left:1rem;">
    Made in USA:
    <select id="filter-made">
      <option value="">All</option>
    </select>
  </label>

  <label style="margin-left:1rem;">
    Vibe:
    <select id="filter-vibe">
      <option value="">All</option>
    </select>
  </label>
</div>

<table id="sma-table" class="display" style="width:100%">
  <thead>
    <tr>
      <th>Brand</th>
      <th>Garment Type</th>
      <th>Price Point</th>
      <th>Made in USA</th>
      <th>Vibe</th>
    </tr>
  </thead>
</table>

<script>
$(document).ready(function () {
  $('#sma-table').DataTable({
const table = $('#sma-table').DataTable({
  ajax: {
ajax: function (data, callback, settings) {
  Papa.parse('sma_clothes_database.csv', {
    download: true,
    header: true,
    skipEmptyLines: true,
    complete: function (results) {
      // results.data is an array of objects keyed by your CSV headers
      const rows = results.data
        .filter(r => Object.values(r).some(v => String(v || '').trim() !== ''));

      const tableData = rows.map(r => {
        const brand = (r["Brand"] || "").trim();
        const garment = (r["Garment Type"] || "").trim();
        const price = (r["Price Point"] || "").trim();
        const made = (r["Made in USA"] || "").trim();
        const vibe = (r["Vibe"] || "").trim();

        // Prefer "URL Raw" if present, else fall back to "URL"
        const url = (r["URL Raw"] || r["URL"] || "").trim();

        return [
          url
            ? `<a href="${url}" target="_blank" rel="noopener">${brand}</a>`
            : brand,
          garment,
          price,
          made,
          vibe
        ];
      });

      callback({ data: tableData });
    }
  });
},

  },
  initComplete: function () {
    const api = this.api();

    // helper to fill a dropdown with unique column values
    function populateSelect(selectId, colIndex) {
      const select = $(selectId);
      const values = new Set();

      api.column(colIndex).data().each(function (d) {
        // strip HTML if any (brand column is HTML; others should be plain)
        const text = $('<div>').html(d).text().trim();
        if (text) values.add(text);
      });

      Array.from(values).sort().forEach(v => {
        select.append(`<option value="${v}">${v}</option>`);
      });
    }

    // Populate dropdowns (indexes based on visible table columns)
    populateSelect('#filter-garment', 1);
    populateSelect('#filter-price', 2);
    populateSelect('#filter-made', 3);
    populateSelect('#filter-vibe', 4);

    // Hook up filtering
    $('#filter-garment').on('change', function () {
      api.column(1).search(this.value ? '^' + $.fn.dataTable.util.escapeRegex(this.value) + '$' : '', true, false).draw();
    });

    $('#filter-price').on('change', function () {
      api.column(2).search(this.value ? '^' + $.fn.dataTable.util.escapeRegex(this.value) + '$' : '', true, false).draw();
    });

    $('#filter-made').on('change', function () {
      api.column(3).search(this.value ? '^' + $.fn.dataTable.util.escapeRegex(this.value) + '$' : '', true, false).draw();
    });

    $('#filter-vibe').on('change', function () {
      api.column(4).search(this.value ? '^' + $.fn.dataTable.util.escapeRegex(this.value) + '$' : '', true, false).draw();
    });
  }
});
</script>

</body>
</html>

















